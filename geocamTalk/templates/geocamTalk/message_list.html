{% extends "geocamTalk/base.html" %}

{% block title%}GeoCam Talk Messages{% endblock %}

{% block content %}
<h1>
	{% if recipient != None and author != None %}
		Messages to
		{% if recipient == user %}
			me
		{% else %}
			{{recipient.full_name}}
		{% endif %}
		from
		{% if author == user %}
			me
		{% else %}
			{{author.full_name}}
		{% endif %}
	{% else %}
		{% if recipient != None %}
			{% if recipient == user %}
				My
			{% else %}
				{{recipient.full_name}}'s
			{% endif %}
			messages
		{% else %}
			All Messages
		{% endif %}
	{% endif %}
</h1>
<div id="messages">
<dl id="message_list">
{% for m in gc_msg %}
	<dt id="message_{{m.pk}}">
	  On {{ m.get_date_string }}
	  {% if recipient %} 
	  <a href="{% url geocamTalk.views.message_list recipient.username m.author.username %}"> 
          {{ m.get_author_string}}</a>
      {% else %}
          {{ m.get_author_string}}
      {% endif %}
	 	said
	  {% if m.has_geolocation %}<a data-rel="dialog" data-transition="pop" data-inline="true" data-role="button" data-icon="geoCam-map" data-iconpos="notext">Map Info</a>{%endif%}
	  {% if m.has_audio %}
          <a class="media" href="{{m.audio_file.url}}"></a>
      {%endif%}
	</dt>
	<dd id="message_{{m.pk}}_content">
    	<p>{{ m.content}}</p>
	</dd>
{% endfor %}
</dl>

<a href="{% url geocamTalk.views.create_message %}">New Message</a>
</div>
{% endblock %}

{% block js %}

{% endblock %}
